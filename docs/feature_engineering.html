---

title: Features


keywords: fastai
sidebar: home_sidebar

summary: "All things feature engineering"
description: "All things feature engineering"
nb_path: "nbs\04_feature_engineering.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\04_feature_engineering.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%</span><span class="k">load_ext</span> autoreload
<span class="o">%</span><span class="k">autoreload</span> 2
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Read-the-example-df">Read the example df<a class="anchor-link" href="#Read-the-example-df"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="read_football_csv" class="doc_header"><code>read_football_csv</code><a href="https://github.com/omlnaut/betting/tree/master/betting/feature_engineering.py#L10" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>read_football_csv</code>(<strong><code>path</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">read_football_csv</span><span class="p">(</span><span class="n">Path</span><span class="p">(</span><span class="s1">&#39;../data/football_data_uk/raw/germany/D1_1415.csv&#39;</span><span class="p">))</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Div</th>
      <th>Date</th>
      <th>HomeTeam</th>
      <th>AwayTeam</th>
      <th>FTHG</th>
      <th>FTAG</th>
      <th>FTR</th>
      <th>HTHG</th>
      <th>HTAG</th>
      <th>HTR</th>
      <th>...</th>
      <th>BbAv&lt;2.5</th>
      <th>BbAH</th>
      <th>BbAHh</th>
      <th>BbMxAHH</th>
      <th>BbAvAHH</th>
      <th>BbMxAHA</th>
      <th>BbAvAHA</th>
      <th>PSCH</th>
      <th>PSCD</th>
      <th>PSCA</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>D1</td>
      <td>2014-08-22</td>
      <td>Bayern Munich</td>
      <td>Wolfsburg</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>3.00</td>
      <td>22</td>
      <td>-2.00</td>
      <td>2.35</td>
      <td>2.24</td>
      <td>1.73</td>
      <td>1.68</td>
      <td>1.29</td>
      <td>6.67</td>
      <td>10.58</td>
    </tr>
    <tr>
      <th>1</th>
      <td>D1</td>
      <td>2014-08-23</td>
      <td>Dortmund</td>
      <td>Leverkusen</td>
      <td>0</td>
      <td>2</td>
      <td>A</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>...</td>
      <td>2.39</td>
      <td>26</td>
      <td>-1.00</td>
      <td>2.08</td>
      <td>2.02</td>
      <td>1.87</td>
      <td>1.84</td>
      <td>1.75</td>
      <td>4.18</td>
      <td>4.77</td>
    </tr>
    <tr>
      <th>2</th>
      <td>D1</td>
      <td>2014-08-23</td>
      <td>Ein Frankfurt</td>
      <td>Freiburg</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>2.01</td>
      <td>22</td>
      <td>-0.50</td>
      <td>2.05</td>
      <td>2.01</td>
      <td>1.90</td>
      <td>1.86</td>
      <td>2.01</td>
      <td>3.74</td>
      <td>3.92</td>
    </tr>
    <tr>
      <th>3</th>
      <td>D1</td>
      <td>2014-08-23</td>
      <td>FC Koln</td>
      <td>Hamburg</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>...</td>
      <td>2.00</td>
      <td>21</td>
      <td>0.00</td>
      <td>1.50</td>
      <td>1.47</td>
      <td>2.92</td>
      <td>2.70</td>
      <td>2.06</td>
      <td>3.62</td>
      <td>3.86</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D1</td>
      <td>2014-08-23</td>
      <td>Hannover</td>
      <td>Schalke 04</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>...</td>
      <td>2.15</td>
      <td>22</td>
      <td>0.25</td>
      <td>1.89</td>
      <td>1.84</td>
      <td>2.08</td>
      <td>2.04</td>
      <td>3.10</td>
      <td>3.60</td>
      <td>2.37</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 67 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Extract-teams">Extract teams<a class="anchor-link" href="#Extract-teams"> </a></h2>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="extract_teams" class="doc_header"><code>extract_teams</code><a href="https://github.com/omlnaut/betting/tree/master/betting/feature_engineering.py#L21" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>extract_teams</code>(<strong><code>df</code></strong>, <strong><code>home_team</code></strong>=<em><code>'HomeTeam'</code></em>, <strong><code>away_team</code></strong>=<em><code>'AwayTeam'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">teams</span> <span class="o">=</span> <span class="n">extract_teams</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">teams</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;Bayern Munich&#39;,
 &#39;Dortmund&#39;,
 &#39;Ein Frankfurt&#39;,
 &#39;FC Koln&#39;,
 &#39;Hannover&#39;,
 &#39;Hertha&#39;,
 &#39;Hoffenheim&#39;,
 &#39;Paderborn&#39;,
 &#34;M&#39;gladbach&#34;,
 &#39;Augsburg&#39;,
 &#39;Hamburg&#39;,
 &#39;Leverkusen&#39;,
 &#39;Schalke 04&#39;,
 &#39;Stuttgart&#39;,
 &#39;Werder Bremen&#39;,
 &#39;Wolfsburg&#39;,
 &#39;Freiburg&#39;,
 &#39;Mainz&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Game-day">Game day<a class="anchor-link" href="#Game-day"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>There should be n_teams/2 games per gameday.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_gamedays" class="doc_header"><code>add_gamedays</code><a href="https://github.com/omlnaut/betting/tree/master/betting/feature_engineering.py#L34" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_gamedays</code>(<strong><code>df</code></strong>, <strong><code>home_team</code></strong>=<em><code>'HomeTeam'</code></em>, <strong><code>away_team</code></strong>=<em><code>'AwayTeam'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">add_gamedays</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Points">Points<a class="anchor-link" href="#Points"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>3 points for the winning team</li>
<li>0 points for the losing team</li>
<li>1 point for each team when they draw</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>Extract all playing teams (sanity check)</li>
<li>current_points: start with 0 points for each team</li>
<li>home/away_points: empty list</li>
<li>Go trough the matches in order of date (=time of kickoff)<ul>
<li>note current_points for each team</li>
<li>update current points according to match outcome</li>
</ul>
</li>
<li>add columns for home/away points</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Points-accumulation">Points accumulation<a class="anchor-link" href="#Points-accumulation"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_points" class="doc_header"><code>add_points</code><a href="https://github.com/omlnaut/betting/tree/master/betting/feature_engineering.py#L50" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_points</code>(<strong><code>df</code></strong>, <strong><code>home_team</code></strong>=<em><code>'HomeTeam'</code></em>, <strong><code>away_team</code></strong>=<em><code>'AwayTeam'</code></em>, <strong><code>date</code></strong>=<em><code>'Date'</code></em>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">add_points</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Div</th>
      <th>Date</th>
      <th>HomeTeam</th>
      <th>AwayTeam</th>
      <th>FTHG</th>
      <th>FTAG</th>
      <th>FTR</th>
      <th>HTHG</th>
      <th>HTAG</th>
      <th>HTR</th>
      <th>...</th>
      <th>BbMxAHH</th>
      <th>BbAvAHH</th>
      <th>BbMxAHA</th>
      <th>BbAvAHA</th>
      <th>PSCH</th>
      <th>PSCD</th>
      <th>PSCA</th>
      <th>gameday</th>
      <th>home_points</th>
      <th>away_points</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>301</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>Hamburg</td>
      <td>Schalke 04</td>
      <td>2</td>
      <td>0</td>
      <td>H</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>...</td>
      <td>2.11</td>
      <td>2.04</td>
      <td>1.85</td>
      <td>1.80</td>
      <td>2.09</td>
      <td>3.89</td>
      <td>3.54</td>
      <td>33</td>
      <td>32</td>
      <td>48</td>
    </tr>
    <tr>
      <th>303</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>Hoffenheim</td>
      <td>Hertha</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>2.00</td>
      <td>1.95</td>
      <td>1.98</td>
      <td>1.90</td>
      <td>2.14</td>
      <td>3.57</td>
      <td>3.68</td>
      <td>33</td>
      <td>41</td>
      <td>35</td>
    </tr>
    <tr>
      <th>302</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>Hannover</td>
      <td>Freiburg</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>1.97</td>
      <td>1.92</td>
      <td>1.98</td>
      <td>1.92</td>
      <td>2.02</td>
      <td>3.54</td>
      <td>4.11</td>
      <td>33</td>
      <td>34</td>
      <td>34</td>
    </tr>
    <tr>
      <th>304</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>M'gladbach</td>
      <td>Augsburg</td>
      <td>1</td>
      <td>3</td>
      <td>A</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>1.94</td>
      <td>1.89</td>
      <td>2.02</td>
      <td>1.96</td>
      <td>1.47</td>
      <td>5.00</td>
      <td>7.05</td>
      <td>33</td>
      <td>66</td>
      <td>46</td>
    </tr>
    <tr>
      <th>305</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>Paderborn</td>
      <td>Stuttgart</td>
      <td>1</td>
      <td>2</td>
      <td>A</td>
      <td>1</td>
      <td>1</td>
      <td>D</td>
      <td>...</td>
      <td>2.09</td>
      <td>2.02</td>
      <td>1.88</td>
      <td>1.83</td>
      <td>3.56</td>
      <td>4.13</td>
      <td>2.01</td>
      <td>33</td>
      <td>31</td>
      <td>33</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 70 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Positions">Positions<a class="anchor-link" href="#Positions"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_positions" class="doc_header"><code>add_positions</code><a href="https://github.com/omlnaut/betting/tree/master/betting/feature_engineering.py#L94" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_positions</code>(<strong><code>df</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">add_positions</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Div</th>
      <th>Date</th>
      <th>HomeTeam</th>
      <th>AwayTeam</th>
      <th>FTHG</th>
      <th>FTAG</th>
      <th>FTR</th>
      <th>HTHG</th>
      <th>HTAG</th>
      <th>HTR</th>
      <th>...</th>
      <th>BbMxAHA</th>
      <th>BbAvAHA</th>
      <th>PSCH</th>
      <th>PSCD</th>
      <th>PSCA</th>
      <th>gameday</th>
      <th>home_points</th>
      <th>away_points</th>
      <th>home_position</th>
      <th>away_position</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>D1</td>
      <td>2014-08-22</td>
      <td>Bayern Munich</td>
      <td>Wolfsburg</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>1.73</td>
      <td>1.68</td>
      <td>1.29</td>
      <td>6.67</td>
      <td>10.58</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>D1</td>
      <td>2014-08-23</td>
      <td>Dortmund</td>
      <td>Leverkusen</td>
      <td>0</td>
      <td>2</td>
      <td>A</td>
      <td>0</td>
      <td>1</td>
      <td>A</td>
      <td>...</td>
      <td>1.87</td>
      <td>1.84</td>
      <td>1.75</td>
      <td>4.18</td>
      <td>4.77</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>D1</td>
      <td>2014-08-23</td>
      <td>Ein Frankfurt</td>
      <td>Freiburg</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>1.90</td>
      <td>1.86</td>
      <td>2.01</td>
      <td>3.74</td>
      <td>3.92</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>D1</td>
      <td>2014-08-23</td>
      <td>FC Koln</td>
      <td>Hamburg</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>...</td>
      <td>2.92</td>
      <td>2.70</td>
      <td>2.06</td>
      <td>3.62</td>
      <td>3.86</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>D1</td>
      <td>2014-08-23</td>
      <td>Hannover</td>
      <td>Schalke 04</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>...</td>
      <td>2.08</td>
      <td>2.04</td>
      <td>3.10</td>
      <td>3.60</td>
      <td>2.37</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 72 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Simple-diffs">Simple diffs<a class="anchor-link" href="#Simple-diffs"> </a></h3>
</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="add_simple_diffs" class="doc_header"><code>add_simple_diffs</code><a href="https://github.com/omlnaut/betting/tree/master/betting/feature_engineering.py#L115" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>add_simple_diffs</code>(<strong><code>df</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">df</span> <span class="o">=</span> <span class="n">add_simple_diffs</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
<span class="n">df</span><span class="o">.</span><span class="n">tail</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea output_execute_result">
<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Div</th>
      <th>Date</th>
      <th>HomeTeam</th>
      <th>AwayTeam</th>
      <th>FTHG</th>
      <th>FTAG</th>
      <th>FTR</th>
      <th>HTHG</th>
      <th>HTAG</th>
      <th>HTR</th>
      <th>...</th>
      <th>PSCH</th>
      <th>PSCD</th>
      <th>PSCA</th>
      <th>gameday</th>
      <th>home_points</th>
      <th>away_points</th>
      <th>home_position</th>
      <th>away_position</th>
      <th>points_diff</th>
      <th>position_diff</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>301</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>Hamburg</td>
      <td>Schalke 04</td>
      <td>2</td>
      <td>0</td>
      <td>H</td>
      <td>0</td>
      <td>0</td>
      <td>D</td>
      <td>...</td>
      <td>2.09</td>
      <td>3.89</td>
      <td>3.54</td>
      <td>33</td>
      <td>32</td>
      <td>48</td>
      <td>14</td>
      <td>5</td>
      <td>-16</td>
      <td>9</td>
    </tr>
    <tr>
      <th>303</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>Hoffenheim</td>
      <td>Hertha</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>2.14</td>
      <td>3.57</td>
      <td>3.68</td>
      <td>33</td>
      <td>41</td>
      <td>35</td>
      <td>8</td>
      <td>11</td>
      <td>6</td>
      <td>-3</td>
    </tr>
    <tr>
      <th>302</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>Hannover</td>
      <td>Freiburg</td>
      <td>2</td>
      <td>1</td>
      <td>H</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>2.02</td>
      <td>3.54</td>
      <td>4.11</td>
      <td>33</td>
      <td>34</td>
      <td>34</td>
      <td>12</td>
      <td>12</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>304</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>M'gladbach</td>
      <td>Augsburg</td>
      <td>1</td>
      <td>3</td>
      <td>A</td>
      <td>1</td>
      <td>0</td>
      <td>H</td>
      <td>...</td>
      <td>1.47</td>
      <td>5.00</td>
      <td>7.05</td>
      <td>33</td>
      <td>66</td>
      <td>46</td>
      <td>3</td>
      <td>6</td>
      <td>20</td>
      <td>-3</td>
    </tr>
    <tr>
      <th>305</th>
      <td>D1</td>
      <td>2015-05-23</td>
      <td>Paderborn</td>
      <td>Stuttgart</td>
      <td>1</td>
      <td>2</td>
      <td>A</td>
      <td>1</td>
      <td>1</td>
      <td>D</td>
      <td>...</td>
      <td>3.56</td>
      <td>4.13</td>
      <td>2.01</td>
      <td>33</td>
      <td>31</td>
      <td>33</td>
      <td>15</td>
      <td>13</td>
      <td>-2</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 74 columns</p>
</div>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

