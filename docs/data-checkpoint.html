---

title: First source: football-data.co.uk


keywords: fastai
sidebar: home_sidebar

summary: "This page shows how to acquire data from fotball-data.co.uk"
description: "This page shows how to acquire data from fotball-data.co.uk"
nb_path: "nbs\.ipynb_checkpoints\02_data-checkpoint.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: nbs\.ipynb_checkpoints\02_data-checkpoint.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Examine-the-source">Examine the source<a class="anchor-link" href="#Examine-the-source"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Link: <a href="https://www.football-data.co.uk/data.php">https://www.football-data.co.uk/data.php</a></p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>This site provides an extensive list of match statistics, outcomes and odds. However, for some reason there is no easy way to download the data. The main page contains links to the main leagues. Each main league site then provides a list of links to each result csv, <strong>grouped by season and league</strong>.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">mainpage_link</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;https://www.football-data.co.uk/data.php&#39;</span>
<span class="n">mainpage_bs</span> <span class="o">=</span> <span class="n">get_html</span><span class="p">(</span><span class="n">mainpage_link</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Since parallelizatoin doesn't really work from within jupyter notebooks (at least on windows), I'll use this notebook to develop all necessary functions to later run a normal python script (with parallelization).</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Understanding-the-features">Understanding the features<a class="anchor-link" href="#Understanding-the-features"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The column names for this datasource are rather cryptic. Here are the most useful ones:</p>
<ul>
<li><strong>Date</strong></li>
<li><strong>HomeTeam</strong>, <strong>AwayTeam</strong></li>
<li><strong>FTHG*, </strong>FTAG** -&gt; Full Time Home/Away Team Goals</li>
<li><strong>B365H/D/A</strong> Bet365 home/draw/away odds</li>
</ul>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Parsing">Parsing<a class="anchor-link" href="#Parsing"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The following two sections derive the method for generating all necessary download links to the individual csv files. Most of this derivation is not needed in the actual download script and is only kept here for future reference.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Parsing-mainpage-for-country-pages">Parsing mainpage for country pages<a class="anchor-link" href="#Parsing-mainpage-for-country-pages"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The sub-pages we are looking for have sub-urls of roughly the shape: <strong>\&lt;country_name&gt;m.php</strong>, so lets look for links like this.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">php_links</span> <span class="o">=</span> <span class="n">find_links_by_func</span><span class="p">(</span><span class="n">mainpage_bs</span><span class="p">)</span>
            
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Number of php links: {len(php_links)}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Examples:&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">php_links</span><span class="p">[</span><span class="mi">65</span><span class="p">:</span><span class="mi">75</span><span class="p">]))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of php links: 218
Examples:
http://livescore.football-data.co.uk/
http://football-data.bestbetting.com/
ratings.pdf
https://twitter.com/12Xpert
example.csv
notes.txt
englandm.php
scotlandm.php
germanym.php
italym.php
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So the good news is that the links we're looking for are in there. The bad news is that there's also a bunch of other stuff. Lets try using some regex magic.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">country_links</span> <span class="o">=</span> <span class="n">find_links_by_pattern</span><span class="p">(</span><span class="n">mainpage_bs</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\w+m\.php&#39;</span><span class="p">)</span>
<span class="n">country_links</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;englandm.php&#39;,
 &#39;scotlandm.php&#39;,
 &#39;germanym.php&#39;,
 &#39;italym.php&#39;,
 &#39;spainm.php&#39;,
 &#39;francem.php&#39;,
 &#39;netherlandsm.php&#39;,
 &#39;belgiumm.php&#39;,
 &#39;portugalm.php&#39;,
 &#39;turkeym.php&#39;,
 &#39;greecem.php&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Manually checking the site shows that this is exactly the list of links we're looking for. So far so good.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Parsing-country-pages-for-results">Parsing country pages for results<a class="anchor-link" href="#Parsing-country-pages-for-results"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The country links we gathered in the last step are relative. To build the full links we have to join them with the base link.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">example_country_link</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urljoin</span><span class="p">(</span><span class="n">mainpage_link</span><span class="p">,</span> <span class="n">country_links</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">country_html</span> <span class="o">=</span> <span class="n">get_html</span><span class="p">(</span><span class="n">example_country_link</span><span class="p">)</span>
<span class="n">example_country_link</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;https://www.football-data.co.uk/englandm.php&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The result files seem to be located all under the same structure: <a href="https://www.football-data.co.uk/mmz4281/">https://www.football-data.co.uk/mmz4281/</a></p>
<p>The next part that follows is the season, encoded as yyYY. Here yy are the last two digits of the year of the seasons beginning. YY are the last two digits of the year of the seasons ending.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Getting-all-seasons">Getting all seasons<a class="anchor-link" href="#Getting-all-seasons"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll try to parse all available years from the example country page:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">csv_links</span> <span class="o">=</span> <span class="n">find_links_by_pattern</span><span class="p">(</span><span class="n">country_html</span><span class="p">,</span> <span class="s1">&#39;mmz4281/\d</span><span class="si">{4}</span><span class="s1">/\w*\d\.csv&#39;</span><span class="p">)</span>
<span class="n">csv_links</span><span class="p">[:</span><span class="mi">5</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;mmz4281/1920/E0.csv&#39;,
 &#39;mmz4281/1920/E1.csv&#39;,
 &#39;mmz4281/1920/E2.csv&#39;,
 &#39;mmz4281/1920/E3.csv&#39;,
 &#39;mmz4281/1819/E0.csv&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>From here we can easily extract the season data:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seasons</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="n">csv_link</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">csv_link</span> <span class="ow">in</span> <span class="n">csv_links</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Amount of seasons: {len(seasons)}&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;Example: {seasons.__iter__().__next__()}&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Amount of seasons: 27
Example: 0607
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Lets refactor that as preparation for using for all the countries:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">unique_seasons</span><span class="p">(</span><span class="n">html</span><span class="p">):</span>
    <span class="s1">&#39;Returns a list of all unique seasons for which result.csv files are found in the given html&#39;</span>
    <span class="n">csv_links</span> <span class="o">=</span> <span class="n">find_links_by_pattern</span><span class="p">(</span><span class="n">html</span><span class="p">,</span> <span class="s1">&#39;mmz4281/\d</span><span class="si">{4}</span><span class="s1">/\w*\d\.csv&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">set</span><span class="p">(</span><span class="n">csv_link</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">csv_link</span> <span class="ow">in</span> <span class="n">csv_links</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">assert</span> <span class="n">unique_seasons</span><span class="p">(</span><span class="n">country_html</span><span class="p">)</span><span class="o">==</span><span class="n">seasons</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">country_links</span> <span class="o">=</span> <span class="p">[</span><span class="n">urllib</span><span class="o">.</span><span class="n">parse</span><span class="o">.</span><span class="n">urljoin</span><span class="p">(</span><span class="n">mainpage_link</span><span class="p">,</span> <span class="n">country_link</span><span class="p">)</span> <span class="k">for</span> <span class="n">country_link</span> <span class="ow">in</span> <span class="n">country_links</span><span class="p">]</span>

<span class="n">seasons</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">country_link</span> <span class="ow">in</span> <span class="n">country_links</span><span class="p">[</span><span class="mi">1</span><span class="p">:]:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Processing &#39;</span><span class="p">,</span> <span class="n">country_link</span><span class="p">)</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">get_html</span><span class="p">(</span><span class="n">country_link</span><span class="p">)</span>
    <span class="n">unique</span> <span class="o">=</span> <span class="n">unique_seasons</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">unique</span><span class="p">:</span>
        <span class="n">seasons</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">unique</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Found no seasons&#39;</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Processing  https://www.football-data.co.uk/scotlandm.php
Processing  https://www.football-data.co.uk/germanym.php
Processing  https://www.football-data.co.uk/italym.php
Processing  https://www.football-data.co.uk/spainm.php
Processing  https://www.football-data.co.uk/francem.php
Processing  https://www.football-data.co.uk/netherlandsm.php
Processing  https://www.football-data.co.uk/belgiumm.php
Processing  https://www.football-data.co.uk/portugalm.php
Processing  https://www.football-data.co.uk/turkeym.php
Processing  https://www.football-data.co.uk/greecem.php
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Let's see which seasons are available for all leagues:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">seasons</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">functools</span><span class="o">.</span><span class="n">reduce</span><span class="p">(</span><span class="k">lambda</span> <span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="p">:</span> <span class="n">a</span><span class="o">.</span><span class="n">intersection</span><span class="p">(</span><span class="n">b</span><span class="p">),</span> <span class="n">seasons</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of available complete leagues:&#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">seasons</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">seasons</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of available complete leagues: 25
0607, 9899, 1516, 1415, 0809, 0102, 0001, 0304, 0203, 0405, 1718, 1314, 9697, 9900, 1819, 1617, 1011, 9798, 1112, 0910, 1920, 9596, 1213, 0708, 0506
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So appearently the data goes from 1995/96 all the way up to 2019/2020 (the currently running season). I'll grab all the data that's available, we can sort it out later.</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h4 id="Getting-the-correct-sub-league">Getting the correct sub-league<a class="anchor-link" href="#Getting-the-correct-sub-league"> </a></h4>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Looking at the csv links from earlier, the next part is a sub-league code, in this case 'E0'.</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">csv_links</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;mmz4281/1920/E0.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The letter(s) in this code refer to the country in which the season is played. The number seems to be a sort-of ranking. For most countries, number 1 is assigned to the highest league. But not for all. In the example above for england, number 0 is assigned to the premier league. We'll therefore try to get all the relevant subleague-number -&gt; subleague-name mappings.</p>
<p>We still have the example html code some country page.</p>
<p>Since we know that each country page has links to the last season (18/19), we'll parse for result links for this season:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">find_subpage_mapping</span><span class="p">(</span><span class="n">country_html</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">link</span> <span class="ow">in</span> <span class="n">find_links_by_pattern</span><span class="p">(</span><span class="n">country_html</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;mmz4281/1819/\w*\d\.csv&#39;</span><span class="p">,</span> <span class="n">return_href</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">match</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">match</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;mmz4281/1819/(\w*\d)\.csv&#39;</span><span class="p">,</span> <span class="n">link</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;href&#39;</span><span class="p">))</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">&#39;{match.group(1)}: </span><span class="si">{link.text}</span><span class="s1">&#39;</span><span class="p">)</span>
        
<span class="n">find_subpage_mapping</span><span class="p">(</span><span class="n">country_html</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>E0: Premier League
E1: Championship
E2: League 1
E3: League 2
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">for</span> <span class="n">country_link</span> <span class="ow">in</span> <span class="n">country_links</span><span class="p">:</span>
    <span class="n">html</span> <span class="o">=</span> <span class="n">get_html</span><span class="p">(</span><span class="n">country_link</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">country_link</span><span class="p">)</span>
    <span class="n">find_subpage_mapping</span><span class="p">(</span><span class="n">html</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="o">*</span><span class="mi">20</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>--------------------
https://www.football-data.co.uk/englandm.php
E0: Premier League
E1: Championship
E2: League 1
E3: League 2
--------------------
--------------------
https://www.football-data.co.uk/scotlandm.php
SC0: Premier League
SC1: Division 1
SC2: Division 2
SC3: Division 3
--------------------
--------------------
https://www.football-data.co.uk/germanym.php
D1: Bundesliga 1
D2: Bundesliga 2
--------------------
--------------------
https://www.football-data.co.uk/italym.php
I1: Serie A
I2: Serie B
--------------------
--------------------
https://www.football-data.co.uk/spainm.php
SP1: La Liga Primera Division
SP2: La Liga Segunda Division
--------------------
--------------------
https://www.football-data.co.uk/francem.php
F1: Le Championnat
F2: Division 2
--------------------
--------------------
https://www.football-data.co.uk/netherlandsm.php
N1: Eredivisie
--------------------
--------------------
https://www.football-data.co.uk/belgiumm.php
B1: Jupiler League
--------------------
--------------------
https://www.football-data.co.uk/portugalm.php
P1: Liga I
--------------------
--------------------
https://www.football-data.co.uk/turkeym.php
T1: Futbol Ligi 1
--------------------
--------------------
https://www.football-data.co.uk/greecem.php
G1: Ethniki Katigoria
--------------------
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We're interested in the highest league for each country, we'll manually grab those codes:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="League" class="doc_header"><code>class</code> <code>League</code><a href="https://github.com/omlnaut/betting/tree/master/betting/data/football_uk.py#L22" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>League</code>(<strong><code>name</code></strong>:<code>str</code>, <strong><code>code</code></strong>:<code>str</code>)</p>
</blockquote>
<p>League(name: str, code: str)</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Putting-it-all-together">Putting it all together<a class="anchor-link" href="#Putting-it-all-together"> </a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We have all the seasons and league information:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">FOOTBALL_DATA_LEAGUES</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[League(name=&#39;england&#39;, code=&#39;E0&#39;),
 League(name=&#39;scotland&#39;, code=&#39;E0&#39;),
 League(name=&#39;germany&#39;, code=&#39;D1&#39;),
 League(name=&#39;italy&#39;, code=&#39;I1&#39;),
 League(name=&#39;spain&#39;, code=&#39;SP1&#39;),
 League(name=&#39;france&#39;, code=&#39;F1&#39;),
 League(name=&#39;netherlands&#39;, code=&#39;N1&#39;),
 League(name=&#39;belgium&#39;, code=&#39;B1&#39;),
 League(name=&#39;portugal&#39;, code=&#39;P1&#39;),
 League(name=&#39;turkey&#39;, code=&#39;T1&#39;),
 League(name=&#39;greece&#39;, code=&#39;G1&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">FOOTBALL_DATA_SEASONS</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>[&#39;1314&#39;,
 &#39;9900&#39;,
 &#39;1112&#39;,
 &#39;9697&#39;,
 &#39;0708&#39;,
 &#39;1920&#39;,
 &#39;9798&#39;,
 &#39;1819&#39;,
 &#39;0405&#39;,
 &#39;9596&#39;,
 &#39;0001&#39;,
 &#39;1213&#39;,
 &#39;0203&#39;,
 &#39;0102&#39;,
 &#39;0809&#39;,
 &#39;1617&#39;,
 &#39;1516&#39;,
 &#39;1718&#39;,
 &#39;1011&#39;,
 &#39;0506&#39;,
 &#39;0607&#39;,
 &#39;9899&#39;,
 &#39;0304&#39;,
 &#39;1415&#39;,
 &#39;0910&#39;]</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of leagues: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FOOTBALL_DATA_LEAGUES</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Number of seasons for each league: &#39;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">FOOTBALL_DATA_SEASONS</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Number of leagues:  11
Number of seasons for each league:  25
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For a given league and season</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">season</span> <span class="o">=</span> <span class="n">FOOTBALL_DATA_SEASONS</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span>
<span class="n">league_code</span> <span class="o">=</span> <span class="n">FOOTBALL_DATA_LEAGUES</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">code</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Season: &#39;</span><span class="p">,</span> <span class="n">season</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;League code: &#39;</span><span class="p">,</span> <span class="n">league_code</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Season:  1920
League code:  B1
</pre>
</div>
</div>

</div>
</div>

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>we can generate the link to the results file:</p>

</div>
</div>
</div>
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="build_full_link" class="doc_header"><code>build_full_link</code><a href="https://github.com/omlnaut/betting/tree/master/betting/data/football_uk.py#L29" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>build_full_link</code>(<strong><code>season</code></strong>, <strong><code>league_code</code></strong>, <strong><code>mainpage_link</code></strong>)</p>
</blockquote>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">build_full_link</span><span class="p">(</span><span class="n">season</span><span class="p">,</span> <span class="n">league_code</span><span class="p">,</span> <span class="n">mainpage_link</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&#39;https://www.football-data.co.uk/mmz4281/1920/B1.csv&#39;</pre>
</div>

</div>

</div>
</div>

</div>
    {% endraw %}

</div>
 

